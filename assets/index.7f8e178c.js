var ye=Object.defineProperty,we=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var $=(t,n,r)=>n in t?ye(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,I=(t,n)=>{for(var r in n||(n={}))ve.call(n,r)&&$(t,r,n[r]);if(te)for(var r of te(n))Ce.call(n,r)&&$(t,r,n[r]);return t},z=(t,n)=>we(t,xe(n));var y=(t,n,r)=>($(t,typeof n!="symbol"?n+"":n,r),r);import{u as _e,a as Se,c as ae,b as Ie,r as u,j as a,T as ke,d as e,C as Te,A as Pe,e as ne,f as Ee,g,B as X,I as oe,h as Oe,M as Ae,i as re,k as G,p as A,l as Ne,m as Le,n as Re,P as O,S as k,o as W,q as C,L as U,s as De,D as je,t as Ge,F as K,v as J,w as q,x as H,G as D,y as ie,z as se,E as le,H as Ue,J as ce,K as Be,N as Fe,O as Me,Q as ze,R as qe,U as We,V as Ke,W as He,X as Ye,Y as Je,Z as Ze,_ as Ve,$ as Z}from"./vendor.19d52727.js";const $e=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};$e();const F=()=>_e(),B=Se,Xe={authed:!!localStorage.getItem("TOKEN")},de=ae({name:"user",initialState:Xe,reducers:{login(t){t.authed=!0},logout(t){t.authed=!1}}}),{login:Qe,logout:Q}=de.actions;var et=de.reducer;const tt=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,nt=Ie({palette:{mode:tt?"dark":"light"}});function rt(t){const n=F(),r=B(f=>f.user.authed),[s,o]=u.exports.useState(null),i=f=>{o(f.currentTarget)},l=()=>{o(null)},c=()=>{o(null),n(A("/")),n(Q()),localStorage.removeItem("TOKEN")};return a(ke,{theme:nt,children:[e(Te,{}),e(Pe,{position:"absolute",color:"default",elevation:0,sx:{position:"relative",borderBottom:f=>`1px solid ${f.palette.divider}`},children:e(ne,{maxWidth:"xl",children:a(Ee,{disableGutters:!0,children:[e(g,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,mr:2,display:{xs:"none",md:"flex"}},children:"Furcation Registration"}),a(X,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[e(oe,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:i,color:"inherit",children:e(Oe,{})}),a(Ae,{id:"menu-appbar",anchorEl:s,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(s),onClose:l,sx:{display:{xs:"block",md:"none"}},children:[r?e(re,{onClick:c,children:e(g,{textAlign:"center",children:"Logout"})}):null,e(re,{onClick:l,children:e("a",{href:"//furcation.org.uk",children:e(g,{textAlign:"center",children:"Return to main site"})})})]})]}),e(g,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:"Furcation Registration"}),a(X,{sx:{display:{xs:"none",md:"flex"}},children:[r?e(G,{onClick:c,sx:{my:2,display:"block"},children:"Logout"}):null,e(G,{onClick:l,sx:{my:2,display:"block"},href:"//furcation.org.uk",children:"Return to main site"})]})]})})}),e(ne,{component:"main",children:t.children})]})}const at={config:{}},ue=ae({name:"config",initialState:at,reducers:{setConfig(t,n){t.config=n.payload}}}),{setConfig:ot}=ue.actions;var it=ue.reducer;const{createReduxHistory:st,routerMiddleware:lt,routerReducer:ct}=Ne({history:Le()}),ee=Re({reducer:{router:ct,user:et,config:it},middleware:[lt]}),dt=st(ee);function ut(){const t=F(),n=B(s=>s.config.config.INTRO_TEXT||""),r=B(s=>s.user.authed);return u.exports.useEffect(()=>{r&&t(A("/manage"))},[]),a(O,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[e(g,{variant:"h6",color:"inherit",children:"Welcome to Furcation 2022 Registation"}),n.split(`
`).map((s,o)=>e(g,{variant:"body1",color:"inherit",paragraph:!0,children:s},o)),a(k,{spacing:2,alignItems:"center",children:[e(G,{variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>t(A("/newregistration")),children:"Register for Furcation"}),e(G,{variant:"outlined",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>t(A("/login")),children:"Already registered? Log in"})]})]})}const T=window.location.hostname=="localhost"?"http://localhost:8000/":"https://api.reg.furcation.org.uk/";function ht(t,n){return fetch(T+"auth/users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z(I({},t),{recaptcha_token:n}))})}function mt(t,n){return fetch(T+"auth/token/login/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({email:t,password:n})})}function gt(){return fetch(T+"auth/users/me/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function ft(t){return fetch(T+"auth/users/me/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function pt(){return fetch(T+"group/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function bt(){return fetch(T+"group/",{method:"POST",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function yt(){return fetch(T+"group/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function wt(t){return fetch(T+"group/",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({id:t})})}function xt(){return fetch(T+"badge-image/",{method:"POST",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function vt(t,n){return fetch(t,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:n})}function Ct(){return fetch(T+"badge-image/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function _t(){return fetch(T+"config/",{method:"GET"})}function St(t,n){return fetch(T+"auth/users/activation/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:t,token:n})})}function It(){const t=F(),[n,r]=u.exports.useState(""),[s,o]=u.exports.useState(""),[i,l]=u.exports.useState(!1),[c,f]=u.exports.useState(""),[x,_]=u.exports.useState(""),N=B(p=>p.user.authed);return u.exports.useEffect(()=>{N&&t(A("/manage"));const p=new URLSearchParams(window.location.search),d=p.get("uid"),m=p.get("token");!N&&d&&m&&St(d,m).then(L=>{L.status==204||L.status==403?_("Email verified!  You can now login below."):(f("Error while validating email."),L.json().then(b=>console.log(b)))})},[]),a(k,{component:"form",onSubmit:p=>{p.preventDefault(),l(!0),mt(n,s).then(d=>{d.status==200?d.json().then(m=>{localStorage.setItem("TOKEN",m.auth_token),t(Qe()),t(A("/manage"))}):d.json().then(m=>{console.log(m),f(m.non_field_errors),l(!1)})})},spacing:2,sx:{my:{xs:3,md:3}},children:[c?e(W,{severity:"error",children:c}):null,x?e(W,{severity:"success",children:x}):null,e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:a(k,{spacing:2,children:[e(g,{variant:"h6",color:"inherit",children:"Sign in"}),e(C,{required:!0,fullWidth:!0,autoFocus:!0,disabled:i,type:"email",autoComplete:"email",name:"email",value:n,onChange:p=>{r(p.target.value)},label:"Email Address"}),e(C,{required:!0,fullWidth:!0,disabled:i,type:"password",name:"password",onChange:p=>{o(p.target.value)},value:s,label:"Password"})]})}),e(U,{loading:i,loadingPosition:"center",type:"submit",variant:"contained",children:"Login"})]})}function he(t){const n=r=>{t.emergencyContact[r.target.name]=r.target.value,t.onChange(t.emergencyContact)};return a(k,{spacing:2,children:[e(g,{variant:"h6",color:"inherit",children:"Emergency Contacts"}),e(g,{variant:"body1",color:"inherit",children:"Please provide a contact we can call in case of emergency"}),e(C,{required:!0,disabled:t.disabled,name:"ice_name",label:"Emergency Contact Name",value:t.emergencyContact.ice_name,onChange:n,autoComplete:"phone",error:Object.prototype.hasOwnProperty.call(t.errors,"ice_name"),helperText:t.errors.ice_name}),e(C,{required:!0,disabled:t.disabled,type:"tel",name:"ice_phone",label:"Emergency Phone Number",value:t.emergencyContact.ice_phone,onChange:n,autoComplete:"ice_phone",error:Object.prototype.hasOwnProperty.call(t.errors,"ice_phone"),helperText:t.errors.ice_phone})]})}class me{constructor(){y(this,"email","");y(this,"full_name","");y(this,"nickname","");y(this,"date_of_birth","1990-01-01");y(this,"address","");y(this,"phone_number","");y(this,"medical_details","");y(this,"ice_name","");y(this,"ice_phone","");y(this,"is_sponsor",!1);y(this,"is_early",!1);y(this,"is_late",!1);y(this,"is_fursuiter",!1)}}class kt extends me{constructor(){super(...arguments);y(this,"confirm_email","");y(this,"password","");y(this,"confirm_password","")}}class Tt extends me{constructor(){super(...arguments);y(this,"id",0);y(this,"badge_override","");y(this,"badge_image","")}}function ge(t){const[n,r]=u.exports.useState(t.userInfo.date_of_birth),s=l=>{const c=new Date(l),f=c.getFullYear()+"-"+("0"+(c.getMonth()+1)).slice(-2)+"-"+("0"+c.getDate()).slice(-2);r(f),t.userInfo.date_of_birth=f,t.onChange(t.userInfo)},o=l=>{t.userInfo[l.target.name]=l.target.value,t.onChange(t.userInfo)},i=l=>{t.userInfo[l.target.name]=l.target.checked,t.onChange(t.userInfo)};return a(k,{spacing:2,children:[e(C,{required:!0,disabled:t.disabled,name:"full_name",label:"Full (Legal) Name",value:t.userInfo.full_name,onChange:o,autoComplete:"fullname",error:Object.prototype.hasOwnProperty.call(t.errors,"full_name"),helperText:t.errors.full_name}),e(C,{required:!0,disabled:t.disabled,name:"nickname",label:"Furry Name (Nickname/Badge Name)",value:t.userInfo.nickname,onChange:o,autoComplete:"nickname",error:Object.prototype.hasOwnProperty.call(t.errors,"nickname"),helperText:t.errors.nickname}),e(De,{dateAdapter:je,children:e(Ge,{label:"Date of Birth (yyyy-mm-dd)",disabled:t.disabled,value:n,onChange:s,inputFormat:"yyyy-MM-dd",mask:"____-__-__",renderInput:l=>e(C,z(I({name:"date_of_birth"},l),{required:!0,error:Object.prototype.hasOwnProperty.call(t.errors,"date_of_birth"),helperText:t.errors.date_of_birth}))})}),e(C,{required:!0,multiline:!0,disabled:t.disabled,rows:4,name:"address",label:"Address",value:t.userInfo.address,onChange:o,error:Object.prototype.hasOwnProperty.call(t.errors,"address"),helperText:t.errors.address}),e(C,{required:!0,disabled:t.disabled,type:"tel",name:"phone_number",label:"Phone Number",autoComplete:"phone",value:t.userInfo.phone_number,onChange:o,error:Object.prototype.hasOwnProperty.call(t.errors,"phone_number"),helperText:t.errors.phone_number}),e(C,{multiline:!0,disabled:t.disabled,rows:4,name:"medical_details",label:"Any medical details we should know? (optional)",value:t.userInfo.medical_details||"",onChange:o,error:Object.prototype.hasOwnProperty.call(t.errors,"medical_details"),helperText:t.errors.medical_details}),t.isSignup?null:a(K,{children:[e(J,{control:e(q,{name:"is_fursuiter",checked:t.userInfo.is_fursuiter,onChange:i}),label:"I'm bringing my fursuit"}),e(g,{variant:"h6",color:"inherit",children:"Early/Late Arrival"}),a(g,{variant:"body1",color:"inherit",children:["You can see how early/late arrival will affect your ticket price on the pricing page of our website"," ",e(H,{href:"https://www.furcation.org.uk/attending/pricing/",target:"_blank",children:"here"}),"."]}),e(J,{control:e(q,{name:"is_early",checked:t.userInfo.is_early,onChange:i}),label:"I want to arrive a day early (10th November)"}),e(J,{control:e(q,{name:"is_late",checked:t.userInfo.is_late,onChange:i}),label:"I want to leave a day late (15th November)"}),e(g,{variant:"h6",color:"inherit",children:"Sponsor"}),a(g,{variant:"body1",color:"inherit",children:["You can choose to help support the convention further by becoming one of our sponsors. Sponsoring costs \xA340 and sponsors get a goodybag on arrival. You can read more about sponsoring on our pricing page"," ",e(H,{href:"https://www.furcation.org.uk/attending/pricing/",target:"_blank",children:"here"}),"."]}),e(J,{control:e(q,{name:"is_sponsor",checked:t.userInfo.is_sponsor,onChange:i}),label:"I want to sponsor"})]})]})}function Pt(){return a(k,{spacing:2,children:[e(g,{variant:"h6",color:"inherit",children:"Legal"}),a(g,{variant:"body1",color:"inherit",children:[e(q,{required:!0,name:"t_and_cs"}),"Do you agree to the"," ",e(H,{href:"https://www.furcation.org.uk/docs/privacypolicy.pdf",target:"_blank",children:"privacy policy"})," ","and the"," ",e(H,{href:"https://www.furcation.org.uk/docs/codeofconduct.pdf",target:"_blank",children:"code of conduct"}),"?"]})]})}function Et(){const t=F(),[n,r]=u.exports.useState(new kt),[s,o]=u.exports.useState(!1),[i,l]=u.exports.useState(!1),[c,f]=u.exports.useState({}),[x,_]=u.exports.useState(""),N=B(b=>b.user.authed);u.exports.useEffect(()=>{N&&t(A("/manage"))},[]);const P=b=>{r(z(I({},n),{[b.target.name]:b.target.value}))},R=b=>{r(I(I({},n),b))},h=b=>{r(I(I({},n),b))},p=()=>{t(A("/login"))},d=b=>{const V=Date.parse("11 November 2004");if(b.preventDefault(),o(!0),n.email!==n.confirm_email){m({email:"Email and confirm email did not match."});return}if(n.password!==n.confirm_password){m({password:"Password and confirm password did not match."});return}if(Date.parse(n.date_of_birth)>=V){m({date_of_birth:"You must be 18 years old by November 11th 2022."});return}n.phone_number=L(n.phone_number),n.ice_phone=L(n.ice_phone),console.log(n),window.grecaptcha.enterprise.ready(function(){window.grecaptcha.enterprise.execute("6LeVPFEhAAAAAGC1Sc6mImon0DWwloJD3c_nyRU2",{action:"register"}).then(function(Y){console.log("ReCAPTCHA token: "+Y),ht(n,Y).then(M=>{M.status==201?M.json().then(w=>{_(w.email),l(!0)}):M.json().then(w=>{m(w)})})})})},m=b=>{f(b),o(!1),window.scrollTo(0,0)},L=b=>(b=b.replaceAll(" ",""),b.charAt(0)==="0"?"+44"+b.substring(1):b);return a(k,{component:"form",onSubmit:d,spacing:2,sx:{my:{xs:3,md:6}},children:[Object.keys(c).length>0?e(W,{severity:"error",children:"Something went wrong - Please fix the errors below."}):null,a(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:[e(g,{variant:"h6",color:"inherit",children:"New Registration"}),a(D,{container:!0,spacing:2,sx:{mt:2},children:[e(D,{item:!0,xs:12,sm:6,children:e(C,{required:!0,fullWidth:!0,autoFocus:!0,disabled:s,type:"email",autoComplete:"email",name:"email",value:n.email,onChange:P,label:"Email Address",error:Object.prototype.hasOwnProperty.call(c,"email"),helperText:c.email})}),e(D,{item:!0,xs:12,sm:6,children:e(C,{required:!0,fullWidth:!0,disabled:s,type:"email",name:"confirm_email",onChange:P,value:n.confirm_email,label:"Confirm Email",error:Object.prototype.hasOwnProperty.call(c,"confirm_email"),helperText:c.confirm_email})}),e(D,{item:!0,xs:12,sm:6,children:e(C,{required:!0,fullWidth:!0,disabled:s,type:"password",name:"password",onChange:P,value:n.password,label:"Password",error:Object.prototype.hasOwnProperty.call(c,"password"),helperText:c.password})}),e(D,{item:!0,xs:12,sm:6,children:e(C,{required:!0,fullWidth:!0,disabled:s,type:"password",name:"confirm_password",onChange:P,value:n.confirm_password,label:"Confirm Password",error:Object.prototype.hasOwnProperty.call(c,"confirm_password"),helperText:c.confirm_password})})]})]}),e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(ge,{userInfo:n,onChange:h,disabled:s,errors:c,isSignup:!0})}),e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(he,{emergencyContact:n,onChange:R,disabled:s,errors:c})}),e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(Pt,{})}),e(U,{loading:s,loadingPosition:"center",type:"submit",variant:"contained",children:"Next"}),a(ie,{open:i,onClose:p,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(se,{id:"alert-dialog-title",children:"You're almost done!"}),e(le,{children:a(Ue,{id:"alert-dialog-description",children:["An email has been sent to ",x,". Please click the link in there to verify your account."]})}),e(ce,{children:e(G,{onClick:p,autoFocus:!0,children:"Log In"})})]})]})}function Ot(t){const n=F(),[r,s]=u.exports.useState(null),[o,i]=u.exports.useState(""),[l,c]=u.exports.useState(""),[f,x]=u.exports.useState(!1);u.exports.useEffect(()=>{_()},[]);const _=()=>{pt().then(d=>{x(!1),d.status==200?d.json().then(m=>{s(m)}):d.status==404?s(null):d.status==401&&(n(A("/")),n(Q()),localStorage.removeItem("TOKEN"))})},N=d=>{i(d.target.value.trim())},P=d=>{d.preventDefault(),x(!0),wt(o).then(m=>{m.status==200?(c(""),_()):(x(!1),m.json().then(L=>c(L.details)))})},R=()=>{x(!0),bt().then(d=>{d.status==201?(c(""),_()):(x(!1),d.json().then(m=>c(m.details)))})},h=()=>{r&&navigator.clipboard.writeText(r.id)},p=()=>{x(!0),yt().then(d=>{d.status==200?(c(""),_()):(x(!1),d.json().then(m=>c(m.details)))})};return a(k,{spacing:2,children:[e(g,{variant:"h6",color:"inherit",children:"Accommodation Group"}),a(g,{variant:"body1",color:"inherit",children:["Furcation has a variety of units available to suit various budgets and group sizes. You can read more about accommodation pricing and the features of each type of unit"," ",e(H,{href:"https://www.furcation.org.uk/attending/pricing/",target:"_blank",children:"here"}),"."]}),l?e(W,{severity:"error",children:l}):null,r?a(K,{children:[a(g,{variant:"body1",color:"inherit",children:[r.owner.nickname,"'s group",e(G,{onClick:p,sx:{ml:2},type:"submit",disabled:f,variant:"contained",color:"error",children:t.user.id==r.owner.id?"Disband Group":"Leave Group"})]}),a(g,{variant:"body1",color:"inherit",children:["Group code: ",r.id,e(Be,{title:"Copy",children:e(oe,{"aria-label":"copy",onClick:h,children:e(Fe,{})})})]}),e(Me,{dense:!0,children:r.users.map((d,m)=>e(ze,{children:e(qe,{primary:d.id==r.owner.id?d.nickname+" (host)":d.nickname})},m))})]}):a(K,{children:[e(g,{variant:"body1",color:"inherit",children:"Create a new group, or join someone else's group by entering their group code!"}),a(D,{component:"form",onSubmit:P,container:!0,spacing:2,sx:{mt:2,pr:2},children:[e(D,{item:!0,sm:12,md:5,children:e(C,{size:"small",disabled:f,fullWidth:!0,required:!0,id:"outlined-basic",label:"Group Code",variant:"outlined",value:o,onChange:N})}),e(D,{item:!0,sm:12,md:3,alignItems:"stretch",style:{display:"flex"},children:e(G,{fullWidth:!0,type:"submit",disabled:f,variant:"contained",children:"Join Group"})}),e(D,{item:!0,sm:12,md:4,alignItems:"stretch",style:{display:"flex"},children:e(G,{fullWidth:!0,variant:"outlined",disabled:f,onClick:R,children:"Create New Group"})})]})]})]})}const At=We("input")({display:"none"});function Nt(t){const[s,o]=u.exports.useState(""),[i,l]=u.exports.useState(!1),[c,f]=u.exports.useState({x:0,y:0}),[x,_]=u.exports.useState(1),[N,P]=u.exports.useState({width:100,height:100,x:0,y:0}),[R,h]=u.exports.useState(500);u.exports.useEffect(()=>{h(Math.min(500,window.screen.width-64))},[]);const p=async w=>{if(w.target.files&&w.target.files.length>0){l(!0);const v=w.target.files[0];d(v).then(S=>{f({x:0,y:0}),_(1),l(!1),o(S)})}},d=w=>new Promise(v=>{const S=new FileReader;S.addEventListener("load",()=>v(S.result),!1),S.readAsDataURL(w)}),m=()=>{o("")},L=(w,v)=>{P(v)},b=()=>{l(!0),V(s,N).then(w=>{xt().then(v=>{v.status==201&&v.json().then(S=>{vt(S.upload_url,w).then(()=>{t.badgeImageChanged(S.badge_image),l(!1),m()})})})})},V=async(w,v)=>{const S=await Y(w),E=document.createElement("canvas"),j=E.getContext("2d");if(!j)return null;E.width=S.width,E.height=S.height,j.imageSmoothingEnabled=!0,j.scale(300/v.width,300/v.height),j.drawImage(S,-v.x,-v.y);const fe=j.getImageData(0,0,300,300);return E.width=300,E.height=300,j.putImageData(fe,0,0),new Promise(pe=>{E.toBlob(be=>{pe(be)},"image/jpeg")})},Y=w=>new Promise((v,S)=>{const E=new Image;E.addEventListener("load",()=>v(E)),E.addEventListener("error",j=>S(j)),E.src=w}),M=()=>{l(!0),Ct().then(w=>{w.status==200&&(l(!1),t.badgeImageChanged(""))})};return a(K,{children:[a(k,{spacing:2,children:[e(g,{variant:"h6",color:"inherit",children:"Badge Image"}),t.user.badge_image?a(k,{direction:"row",children:[e("img",{style:{width:"150px",marginRight:"8px"},src:"https://storage.googleapis.com/reggie-badges/"+t.user.badge_image}),e(X,{alignItems:"center",display:"flex",justifyContent:"center",children:e(U,{loading:i,loadingPosition:"center",variant:"contained",color:"error",onClick:M,children:"Delete Badge Image"})})]}):a("label",{htmlFor:"contained-button-file",children:[e(At,{accept:"image/*",id:"contained-button-file",multiple:!0,type:"file",onChange:p}),e(U,{loading:i,loadingPosition:"center",variant:"contained",component:"span",children:"Upload Badge Image"})]})]}),a(ie,{open:!!s,onClose:m,children:[a(se,{children:["Crop Badge Image",e(g,{children:"Scroll or pinch to zoom. Click and drag to move."})]}),e(le,{style:{position:"relative",width:R+"px",height:R+"px"},children:e(Ke,{image:s,crop:c,zoom:x,aspect:1,onCropChange:f,onZoomChange:_,onCropComplete:L})}),e(ce,{children:e(U,{loading:i,loadingPosition:"center",onClick:b,autoFocus:!0,children:"Upload"})})]})]})}function Lt(){const t=F(),[n,r]=u.exports.useState(null),[s,o]=u.exports.useState({}),[i,l]=u.exports.useState(0),c=B(h=>h.user.authed);u.exports.useEffect(()=>{if(!c){t(A("/"));return}gt().then(h=>{h.status==200?h.json().then(p=>{r(Object.assign(new Tt,p))}):h.status==401&&(t(A("/")),t(Q()),localStorage.removeItem("TOKEN"))})},[]);const f=h=>{h.preventDefault(),l(1),n&&(n.phone_number=_(n.phone_number),n.ice_phone=_(n.ice_phone),ft(n).then(p=>{p.status==200?l(2):p.json().then(d=>{x(d),console.log(d)})}))},x=h=>{o(h),l(0),window.scrollTo(0,0)},_=h=>(h=h.replaceAll(" ",""),h.charAt(0)==="0"?"+44"+h.substring(1):h),N=h=>{n&&(l(0),r(I(I({},n),h)))},P=h=>{n&&(l(0),r(I(I({},n),h)))},R=h=>{n&&r(z(I({},n),{badge_image:h}))};return a(k,{spacing:2,sx:{my:{xs:3,md:6}},children:[Object.keys(s).length>0?e(W,{severity:"error",children:"Something went wrong - Please fix the errors below."}):null,n?a(K,{children:[a(k,{component:"form",onSubmit:f,spacing:2,children:[e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:a(k,{spacing:2,children:[e(g,{variant:"h6",color:"inherit",children:"Your Attendee Infomation"}),a(g,{variant:"body1",color:"inherit",children:["Email: ",n.email]}),a(g,{variant:"body1",color:"inherit",children:["Badge Number:"," ",n.badge_override?n.badge_override:n.id]})]})}),e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(ge,{userInfo:n,onChange:P,disabled:i==1,errors:s,isSignup:!1})}),e(U,{loading:i==1,loadingPosition:"center",type:"submit",variant:"contained",color:i==2?"success":"primary",children:i==2?"Saved!":"Save Changes"}),e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(he,{emergencyContact:n,onChange:N,disabled:i==1,errors:s})}),e(U,{loading:i==1,loadingPosition:"center",type:"submit",variant:"contained",color:i==2?"success":"primary",children:i==2?"Saved!":"Save Changes"})]}),e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(Ot,{user:n})}),e(O,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(Nt,{user:n,badgeImageChanged:R})})]}):null]})}He.render(e(Ye.StrictMode,{children:e(Je,{store:ee,children:e(rt,{children:e(Ze,{history:dt,children:a(Ve,{children:[e(Z,{path:"/",element:e(ut,{})}),e(Z,{path:"/login",element:e(It,{})}),e(Z,{path:"/newregistration",element:e(Et,{})}),e(Z,{path:"/manage",element:e(Lt,{})})]})})})})}),document.getElementById("root"));_t().then(t=>{t.status==200&&t.json().then(n=>{const r={};n.results.map(s=>{r[s.id]=s.value}),ee.dispatch(ot(r))})});
