var Ce=Object.defineProperty,xe=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var oe=(t,n,r)=>n in t?Ce(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,L=(t,n)=>{for(var r in n||(n={}))Se.call(n,r)&&oe(t,r,n[r]);if(le)for(var r of le(n))Pe.call(n,r)&&oe(t,r,n[r]);return t},Z=(t,n)=>xe(t,_e(n));var x=(t,n,r)=>(oe(t,typeof n!="symbol"?n+"":n,r),r);import{u as Ie,a as Te,c as ue,b as ke,r as s,j as a,T as Ee,d as e,C as Oe,A as Ae,e as ce,f as De,g as p,L as K,B as $,I as he,h as Le,M as Ne,i as de,k as A,p as P,l as Re,m as Ge,n as je,P as N,S as I,o as U,q as v,s as B,t as Be,D as Fe,v as Ue,F as X,w as ae,x as V,G as j,y as ee,z as te,E as ne,H as Q,J as re,K as We,N as He,O as Me,Q as qe,R as ze,U as Ke,V as Ye,W as Je,X as Ze,Y as Ve,Z as $e,_ as Xe,$ as Qe,a0 as z}from"./vendor.06528c08.js";const et=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerpolicy&&(l.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?l.credentials="include":i.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}};et();const H=()=>Ie(),W=Te,tt={authed:!!localStorage.getItem("TOKEN")},me=ue({name:"user",initialState:tt,reducers:{login(t){t.authed=!0},logout(t){t.authed=!1}}}),{login:nt,logout:ie}=me.actions;var rt=me.reducer;const at=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,ot=ke({palette:{mode:at?"dark":"light"}});function it(t){const n=H(),r=W(h=>h.user.authed),[o,i]=s.exports.useState(null),l=h=>{i(h.currentTarget)},c=()=>{i(null)},d=()=>{i(null),n(P("/")),n(ie()),localStorage.removeItem("TOKEN")};return a(Ee,{theme:ot,children:[e(Oe,{}),e(Ae,{position:"absolute",color:"default",elevation:0,sx:{position:"relative",borderBottom:h=>`1px solid ${h.palette.divider}`},children:e(ce,{maxWidth:"xl",children:a(De,{disableGutters:!0,children:[e(p,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,mr:2,display:{xs:"none",md:"flex"}},children:e(K,{color:"inherit",underline:"none",href:"/",children:"Furcation Registration"})}),a($,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[e(he,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:l,color:"inherit",children:e(Le,{})}),a(Ne,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(o),onClose:c,sx:{display:{xs:"block",md:"none"}},children:[r?e(de,{onClick:d,children:e(p,{textAlign:"center",children:"Logout"})}):null,e(de,{onClick:c,children:e("a",{href:"//furcation.org.uk",children:e(p,{textAlign:"center",children:"Return to main site"})})})]})]}),e(p,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:"Furcation Registration"}),a($,{sx:{display:{xs:"none",md:"flex"}},children:[r?e(A,{onClick:d,sx:{my:2,display:"block"},children:"Logout"}):null,e(A,{onClick:c,sx:{my:2,display:"block"},href:"//furcation.org.uk",children:"Return to main site"})]})]})})}),e(ce,{component:"main",children:t.children})]})}const st={config:{}},ge=ue({name:"config",initialState:st,reducers:{setConfig(t,n){t.config=n.payload}}}),{setConfig:lt}=ge.actions;var ct=ge.reducer;const{createReduxHistory:dt,routerMiddleware:ut,routerReducer:ht}=Re({history:Ge()}),se=je({reducer:{router:ht,user:rt,config:ct},middleware:[ut]}),mt=dt(se);function gt(){const t=H(),n=W(o=>o.config.config.INTRO_TEXT||""),r=W(o=>o.user.authed);return s.exports.useEffect(()=>{r&&t(P("/manage"))},[]),a(N,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[e(p,{variant:"h6",color:"inherit",children:"Welcome to Furcation 2022 Registation"}),n.split(`
`).map((o,i)=>e(p,{variant:"body1",color:"inherit",paragraph:!0,children:o},i)),a(I,{spacing:2,alignItems:"center",children:[e(A,{variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>t(P("/newregistration")),children:"Register for Furcation"}),e(A,{variant:"outlined",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>t(P("/login")),children:"Already registered? Log in"})]})]})}const O=window.location.hostname=="localhost"?"http://localhost:8000/":"https://api.reg.furcation.org.uk/";function pt(t,n){return fetch(O+"auth/users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z(L({},t),{recaptcha_token:n}))})}function ft(t,n){return fetch(O+"auth/token/login/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({email:t,password:n})})}function wt(t,n){return fetch(O+"auth/users/set_password/",{method:"POST",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN"),"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({new_password:t,current_password:n})})}function bt(t){return fetch(O+"auth/users/reset_password/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({email:t})})}function yt(t,n,r){return fetch(O+"auth/users/reset_password_confirm/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({new_password:t,uid:n,token:r})})}function vt(){return fetch(O+"auth/users/me/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Ct(t){return fetch(O+"auth/users/me/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function xt(){return fetch(O+"group/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function _t(){return fetch(O+"group/",{method:"POST",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function St(){return fetch(O+"group/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Pt(t){return fetch(O+"group/",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({id:t})})}function It(){return fetch(O+"badge-image/",{method:"POST",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Tt(t,n){return fetch(t,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:n})}function kt(){return fetch(O+"badge-image/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Et(){return fetch(O+"config/",{method:"GET"})}function Ot(t,n){return fetch(O+"auth/users/activation/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:t,token:n})})}function At(){const t=H(),[n,r]=s.exports.useState(""),[o,i]=s.exports.useState(""),[l,c]=s.exports.useState(!1),[d,h]=s.exports.useState(""),[w,y]=s.exports.useState(""),C=W(u=>u.user.authed);return s.exports.useEffect(()=>{C&&t(P("/manage"));const u=new URLSearchParams(window.location.search),g=u.get("uid"),b=u.get("token");!C&&g&&b&&Ot(g,b).then(f=>{f.status==204||f.status==403?y("Email verified!  You can now login below."):(h("Error while validating email."),f.json().then(m=>console.log(m)))})},[]),a(I,{component:"form",onSubmit:u=>{u.preventDefault(),c(!0),ft(n,o).then(g=>{g.status==200?g.json().then(b=>{localStorage.setItem("TOKEN",b.auth_token),t(nt()),t(P("/manage"))}):g.json().then(b=>{console.log(b),h(b.non_field_errors),c(!1)})})},spacing:2,sx:{my:{xs:3,md:3}},children:[d?e(U,{severity:"error",children:d}):null,w?e(U,{severity:"success",children:w}):null,e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"Sign in"}),e(v,{required:!0,fullWidth:!0,autoFocus:!0,disabled:l,type:"email",autoComplete:"email",name:"email",value:n,onChange:u=>{r(u.target.value)},label:"Email Address"}),e(v,{required:!0,fullWidth:!0,disabled:l,type:"password",name:"password",onChange:u=>{i(u.target.value)},value:o,label:"Password"}),e(B,{loading:l,loadingPosition:"center",type:"submit",variant:"contained",children:"Login"}),e(A,{variant:"outlined",onClick:()=>{t(P("/recover"))},children:"Forgot password?"})]})})]})}function pe(t){const n=r=>{t.emergencyContact[r.target.name]=r.target.value,t.onChange(t.emergencyContact)};return a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"Emergency Contacts"}),e(p,{variant:"body1",color:"inherit",children:"Please provide a contact we can call in case of emergency"}),e(v,{required:!0,disabled:t.disabled,name:"ice_name",label:"Emergency Contact Name",value:t.emergencyContact.ice_name,onChange:n,autoComplete:"phone",error:Object.prototype.hasOwnProperty.call(t.errors,"ice_name"),helperText:t.errors.ice_name}),e(v,{required:!0,disabled:t.disabled,type:"tel",name:"ice_phone",label:"Emergency Phone Number",value:t.emergencyContact.ice_phone,onChange:n,autoComplete:"ice_phone",error:Object.prototype.hasOwnProperty.call(t.errors,"ice_phone"),helperText:t.errors.ice_phone})]})}class fe{constructor(){x(this,"email","");x(this,"full_name","");x(this,"nickname","");x(this,"date_of_birth","1990-01-01");x(this,"address","");x(this,"phone_number","");x(this,"medical_details","");x(this,"ice_name","");x(this,"ice_phone","");x(this,"is_sponsor",!1);x(this,"is_early",!1);x(this,"is_late",!1);x(this,"is_fursuiter",!1)}}class Dt extends fe{constructor(){super(...arguments);x(this,"confirm_email","");x(this,"password","");x(this,"confirm_password","")}}class Lt extends fe{constructor(){super(...arguments);x(this,"id",0);x(this,"badge_override","");x(this,"badge_image","")}}function we(t){const[n,r]=s.exports.useState(t.userInfo.date_of_birth),o=c=>{const d=new Date(c),h=d.getFullYear()+"-"+("0"+(d.getMonth()+1)).slice(-2)+"-"+("0"+d.getDate()).slice(-2);r(h),t.userInfo.date_of_birth=h,t.onChange(t.userInfo)},i=c=>{t.userInfo[c.target.name]=c.target.value,t.onChange(t.userInfo)},l=c=>{t.userInfo[c.target.name]=c.target.checked,t.onChange(t.userInfo)};return a(I,{spacing:2,children:[e(v,{required:!0,disabled:t.disabled,name:"full_name",label:"Full (Legal) Name",value:t.userInfo.full_name,onChange:i,autoComplete:"fullname",error:Object.prototype.hasOwnProperty.call(t.errors,"full_name"),helperText:t.errors.full_name}),e(v,{required:!0,disabled:t.disabled,name:"nickname",label:"Furry Name (Nickname/Badge Name)",value:t.userInfo.nickname,onChange:i,autoComplete:"nickname",error:Object.prototype.hasOwnProperty.call(t.errors,"nickname"),helperText:t.errors.nickname}),e(Be,{dateAdapter:Fe,children:e(Ue,{label:"Date of Birth (yyyy-mm-dd)",disabled:t.disabled,value:n,onChange:o,inputFormat:"yyyy-MM-dd",mask:"____-__-__",renderInput:c=>e(v,Z(L({name:"date_of_birth"},c),{required:!0,error:Object.prototype.hasOwnProperty.call(t.errors,"date_of_birth"),helperText:t.errors.date_of_birth}))})}),e(v,{required:!0,multiline:!0,disabled:t.disabled,rows:4,name:"address",label:"Address",value:t.userInfo.address,onChange:i,error:Object.prototype.hasOwnProperty.call(t.errors,"address"),helperText:t.errors.address}),e(v,{required:!0,disabled:t.disabled,type:"tel",name:"phone_number",label:"Phone Number",autoComplete:"phone",value:t.userInfo.phone_number,onChange:i,error:Object.prototype.hasOwnProperty.call(t.errors,"phone_number"),helperText:t.errors.phone_number}),e(v,{multiline:!0,disabled:t.disabled,rows:4,name:"medical_details",label:"Any medical details we should know? (optional)",value:t.userInfo.medical_details||"",onChange:i,error:Object.prototype.hasOwnProperty.call(t.errors,"medical_details"),helperText:t.errors.medical_details}),t.isSignup?null:a(X,{children:[e(p,{variant:"h6",color:"inherit",children:"Fursuiting"}),e(p,{variant:"body1",color:"inherit",children:"You don't need a fursuit to attend Furcation, but to help us plan for fursuiting events, please let us know if you're bringing your fursuit."}),e(ae,{control:e(V,{name:"is_fursuiter",checked:t.userInfo.is_fursuiter,onChange:l}),label:"I'm bringing my fursuit"}),e(p,{variant:"h6",color:"inherit",children:"Early/Late Arrival"}),a(p,{variant:"body1",color:"inherit",children:["You can see how early/late arrival will affect your ticket price on the pricing page of our website"," ",e(K,{href:"https://www.furcation.org.uk/attending/pricing/",target:"_blank",children:"here"}),"."]}),e(ae,{control:e(V,{name:"is_early",checked:t.userInfo.is_early,onChange:l}),label:"I want to arrive a day early (Arrive on the afternoon of the 10th November)"}),e(ae,{control:e(V,{name:"is_late",checked:t.userInfo.is_late,onChange:l}),label:"I want to leave a day late (Leave on the morning of the 15th November)"}),e(p,{variant:"h6",color:"inherit",children:"Sponsor"}),a(p,{variant:"body1",color:"inherit",children:["You can choose to help support the convention further by becoming one of our sponsors. Sponsoring costs \xA340 and sponsors get a goodybag on arrival. You can read more about sponsoring on our pricing page"," ",e(K,{href:"https://www.furcation.org.uk/attending/pricing/",target:"_blank",children:"here"}),"."]}),e(ae,{control:e(V,{name:"is_sponsor",checked:t.userInfo.is_sponsor,onChange:l}),label:"I want to sponsor"})]})]})}function Nt(){return a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"Legal"}),a(p,{variant:"body1",color:"inherit",children:[e(V,{required:!0,name:"t_and_cs"}),"Do you agree to the"," ",e(K,{href:"https://www.furcation.org.uk/docs/furcation-privacy-policy-1.2.pdf",target:"_blank",children:"privacy policy"})," ","and the"," ",e(K,{href:"https://www.furcation.org.uk/docs/furcation-code-of-conduct.2022.03.pdf",target:"_blank",children:"code of conduct"}),"?"]})]})}function Rt(){const t=H(),[n,r]=s.exports.useState(new Dt),[o,i]=s.exports.useState(!1),[l,c]=s.exports.useState(!1),[d,h]=s.exports.useState({}),[w,y]=s.exports.useState(""),C=W(f=>f.user.authed);s.exports.useEffect(()=>{C&&t(P("/manage"))},[]);const T=f=>{r(Z(L({},n),{[f.target.name]:f.target.value}))},_=f=>{r(L(L({},n),f))},D=f=>{r(L(L({},n),f))},k=()=>{t(P("/login"))},u=f=>{const m=Date.parse("11 November 2004");if(f.preventDefault(),i(!0),n.email!==n.confirm_email){g({email:"Email and confirm email did not match."});return}if(n.password!==n.confirm_password){g({password:"Password and confirm password did not match."});return}if(Date.parse(n.date_of_birth)>=m){g({date_of_birth:"You must be 18 years old by November 11th 2022."});return}n.phone_number=b(n.phone_number),n.ice_phone=b(n.ice_phone),console.log(n),window.grecaptcha.enterprise.ready(function(){window.grecaptcha.enterprise.execute("6LeVPFEhAAAAAGC1Sc6mImon0DWwloJD3c_nyRU2",{action:"register"}).then(function(G){console.log("ReCAPTCHA token: "+G),pt(n,G).then(F=>{F.status==201?F.json().then(S=>{y(S.email),c(!0)}):F.json().then(S=>{g(S)})})})})},g=f=>{h(f),i(!1),window.scrollTo(0,0)},b=f=>(f=f.replaceAll(" ",""),f.charAt(0)==="0"?"+44"+f.substring(1):f);return a(I,{component:"form",onSubmit:u,spacing:2,sx:{my:{xs:3,md:6}},children:[Object.keys(d).length>0?e(U,{severity:"error",children:"Something went wrong - Please fix the errors below."}):null,a(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:[e(p,{variant:"h6",color:"inherit",children:"New Registration"}),a(j,{container:!0,spacing:2,sx:{mt:2},children:[e(j,{item:!0,xs:12,sm:6,children:e(v,{required:!0,fullWidth:!0,autoFocus:!0,disabled:o,type:"email",autoComplete:"email",name:"email",value:n.email,onChange:T,label:"Email Address",error:Object.prototype.hasOwnProperty.call(d,"email"),helperText:d.email})}),e(j,{item:!0,xs:12,sm:6,children:e(v,{required:!0,fullWidth:!0,disabled:o,type:"email",name:"confirm_email",onChange:T,value:n.confirm_email,label:"Confirm Email",error:Object.prototype.hasOwnProperty.call(d,"confirm_email"),helperText:d.confirm_email})}),e(j,{item:!0,xs:12,sm:6,children:e(v,{required:!0,fullWidth:!0,disabled:o,type:"password",name:"password",onChange:T,value:n.password,label:"Password",error:Object.prototype.hasOwnProperty.call(d,"password"),helperText:d.password})}),e(j,{item:!0,xs:12,sm:6,children:e(v,{required:!0,fullWidth:!0,disabled:o,type:"password",name:"confirm_password",onChange:T,value:n.confirm_password,label:"Confirm Password",error:Object.prototype.hasOwnProperty.call(d,"confirm_password"),helperText:d.confirm_password})})]})]}),e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(we,{userInfo:n,onChange:D,disabled:o,errors:d,isSignup:!0})}),e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(pe,{emergencyContact:n,onChange:_,disabled:o,errors:d})}),e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(Nt,{})}),e(B,{loading:o,loadingPosition:"center",type:"submit",variant:"contained",children:"Next"}),a(ee,{open:l,onClose:k,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(te,{id:"alert-dialog-title",children:"You're almost done!"}),e(ne,{children:a(Q,{id:"alert-dialog-description",children:["An email has been sent to ",w,". Please click the link in there to verify your account."]})}),e(re,{children:e(A,{onClick:k,autoFocus:!0,children:"Log In"})})]})]})}function Gt(t){const n=H(),[r,o]=s.exports.useState(null),[i,l]=s.exports.useState(""),[c,d]=s.exports.useState(""),[h,w]=s.exports.useState(!1);s.exports.useEffect(()=>{y()},[]);const y=()=>{xt().then(u=>{w(!1),u.status==200?u.json().then(g=>{o(g)}):u.status==404?o(null):u.status==401&&(n(P("/")),n(ie()),localStorage.removeItem("TOKEN"))})},C=u=>{l(u.target.value.trim())},T=u=>{u.preventDefault(),w(!0),Pt(i).then(g=>{g.status==200?(d(""),y()):(w(!1),g.json().then(b=>d(b.details)))})},_=()=>{w(!0),_t().then(u=>{u.status==201?(d(""),y()):(w(!1),u.json().then(g=>d(g.details)))})},D=()=>{r&&navigator.clipboard.writeText(r.id)},k=()=>{w(!0),St().then(u=>{u.status==200?(d(""),y()):(w(!1),u.json().then(g=>d(g.details)))})};return a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"Accommodation Group"}),a(p,{variant:"body1",color:"inherit",children:["Furcation has a variety of units available to suit various budgets and group sizes. You can read more about accommodation pricing and the features of each type of unit"," ",e(K,{href:"https://www.furcation.org.uk/attending/pricing/",target:"_blank",children:"here"}),". During pre-reg you cannot select an accommodation, but you can choose who you wish to group with."]}),c?e(U,{severity:"error",children:c}):null,r?a(X,{children:[a(p,{variant:"body1",color:"inherit",children:[r.owner.nickname,"'s group",e(A,{onClick:k,sx:{ml:2},type:"submit",disabled:h,variant:"contained",color:"error",children:t.user.id==r.owner.id?"Disband Group":"Leave Group"})]}),a(p,{variant:"body1",color:"inherit",children:["Group code: ",r.id,e(We,{title:"Copy",children:e(he,{"aria-label":"copy",onClick:D,children:e(He,{})})})]}),e(Me,{dense:!0,children:r.users.map((u,g)=>e(qe,{children:e(ze,{primary:u.id==r.owner.id?u.nickname+" (host)":u.nickname})},g))})]}):a(X,{children:[e(p,{variant:"body1",color:"inherit",children:"Create a new group, or join someone else's group by entering their group code!"}),a(j,{component:"form",onSubmit:T,container:!0,spacing:2,sx:{mt:2,pr:2},children:[e(j,{item:!0,sm:12,md:5,children:e(v,{size:"small",disabled:h,fullWidth:!0,required:!0,id:"outlined-basic",label:"Group Code",variant:"outlined",value:i,onChange:C})}),e(j,{item:!0,sm:12,md:3,alignItems:"stretch",style:{display:"flex"},children:e(A,{fullWidth:!0,type:"submit",disabled:h,variant:"contained",children:"Join Group"})}),e(j,{item:!0,sm:12,md:4,alignItems:"stretch",style:{display:"flex"},children:e(A,{fullWidth:!0,variant:"outlined",disabled:h,onClick:_,children:"Create New Group"})})]})]})]})}const jt=Ke("input")({display:"none"});function Bt(t){const[o,i]=s.exports.useState(""),[l,c]=s.exports.useState(!1),[d,h]=s.exports.useState({x:0,y:0}),[w,y]=s.exports.useState(1),[C,T]=s.exports.useState({width:100,height:100,x:0,y:0}),[_,D]=s.exports.useState(500);s.exports.useEffect(()=>{D(Math.min(500,window.screen.width-64))},[]);const k=async S=>{if(S.target.files&&S.target.files.length>0){c(!0);const E=S.target.files[0];u(E).then(R=>{h({x:0,y:0}),y(1),c(!1),i(R)})}},u=S=>new Promise(E=>{const R=new FileReader;R.addEventListener("load",()=>E(R.result),!1),R.readAsDataURL(S)}),g=()=>{i("")},b=(S,E)=>{T(E)},f=()=>{c(!0),m(o,C).then(S=>{It().then(E=>{E.status==201&&E.json().then(R=>{Tt(R.upload_url,S).then(()=>{t.badgeImageChanged(R.badge_image),c(!1),g()})})})})},m=async(S,E)=>{const J=await G(S),M=document.createElement("canvas"),q=M.getContext("2d");if(!q)return null;M.width=Math.max(J.width,300),M.height=Math.max(J.height,300),q.imageSmoothingEnabled=!0,q.scale(300/E.width,300/E.height),q.drawImage(J,-E.x,-E.y);const be=q.getImageData(0,0,300,300);return M.width=300,M.height=300,q.putImageData(be,0,0),new Promise(ye=>{M.toBlob(ve=>{ye(ve)},"image/jpeg")})},G=S=>new Promise((E,R)=>{const Y=new Image;Y.addEventListener("load",()=>E(Y)),Y.addEventListener("error",J=>R(J)),Y.src=S}),F=()=>{c(!0),kt().then(S=>{S.status==200&&(c(!1),t.badgeImageChanged(""))})};return a(X,{children:[a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"Badge Image"}),t.user.badge_image?a(I,{direction:"row",children:[e("img",{style:{width:"150px",marginRight:"8px"},src:"https://storage.googleapis.com/reggie-badges/"+t.user.badge_image}),e($,{alignItems:"center",display:"flex",justifyContent:"center",children:e(B,{loading:l,loadingPosition:"center",variant:"contained",color:"error",onClick:F,children:"Delete Badge Image"})})]}):a("label",{htmlFor:"contained-button-file",children:[e(jt,{accept:"image/*",id:"contained-button-file",multiple:!0,type:"file",onChange:k}),e(B,{loading:l,loadingPosition:"center",variant:"contained",component:"span",children:"Upload Badge Image"})]})]}),a(ee,{open:!!o,onClose:g,children:[a(te,{children:["Crop Badge Image",e(p,{children:"Scroll or pinch to zoom. Click and drag to move."})]}),e(ne,{style:{position:"relative",width:_+"px",height:_+"px"},children:e(Ye,{image:o,crop:d,zoom:w,aspect:1,onCropChange:h,onZoomChange:y,onCropComplete:b})}),e(re,{children:e(B,{loading:l,loadingPosition:"center",onClick:f,autoFocus:!0,children:"Upload"})})]})]})}function Ft(t){const[n,r]=s.exports.useState(""),[o,i]=s.exports.useState(""),[l,c]=s.exports.useState(""),[d,h]=s.exports.useState(""),w=_=>{r(_.target.value)},y=_=>{i(_.target.value)},C=_=>{c(_.target.value)},T=_=>{if(_.preventDefault(),o==n){h("You cannot set a new password similar to your old password");return}if(o!=l){h("These passwords do not match");return}wt(o,n).then(D=>{D.status==204?t.handleClose(!0):D.json().then(k=>{h(k[Object.keys(k)[0]][0]),console.log(k)})})};return e(ee,{open:t.open,onClose:()=>t.handleClose(!1),children:a($,{component:"span",sx:{p:1},children:[e(te,{children:"Change Password"}),a(ne,{children:[e(Q,{sx:{pb:2},children:d?e(U,{severity:"error",variant:"outlined",children:d}):null}),e(Q,{children:"To change your password please input your current password, and then your new password twice."}),e(v,{autoFocus:!0,margin:"dense",id:"currentpassword",label:"Current Password",type:"password",fullWidth:!0,onChange:w,variant:"standard"}),e(v,{autoFocus:!0,margin:"dense",id:"newpassword",label:"New Password",type:"password",fullWidth:!0,onChange:y,variant:"standard"}),e(v,{autoFocus:!0,margin:"dense",id:"newpasswordrepeat",label:"New Password (Again)",type:"password",fullWidth:!0,onChange:C,variant:"standard"})]}),a(re,{children:[e(A,{onClick:()=>t.handleClose(!1),children:"Cancel"}),e(A,{onClick:T,variant:"contained",children:"Submit"})]})]})})}function Ut(){const t=H(),[n,r]=s.exports.useState(null),[o,i]=s.exports.useState({}),[l,c]=s.exports.useState(0),[d,h]=s.exports.useState(!1),[w,y]=s.exports.useState(""),C=()=>{h(!0)},T=m=>{m&&y("Password Changed"),h(!1)},_=W(m=>m.user.authed);s.exports.useEffect(()=>{if(!_){t(P("/"));return}vt().then(m=>{m.status==200?m.json().then(G=>{r(Object.assign(new Lt,G))}):m.status==401&&(t(P("/")),t(ie()),localStorage.removeItem("TOKEN"))})},[]);const D=m=>{m.preventDefault(),c(1),n&&(n.phone_number=u(n.phone_number),n.ice_phone=u(n.ice_phone),Ct(n).then(G=>{G.status==200?c(2):G.json().then(F=>{k(F),console.log(F)})}))},k=m=>{i(m),c(0),window.scrollTo(0,0)},u=m=>(m=m.replaceAll(" ",""),m.charAt(0)==="0"?"+44"+m.substring(1):m),g=m=>{n&&(c(0),r(L(L({},n),m)))},b=m=>{n&&(c(0),r(L(L({},n),m)))},f=m=>{n&&r(Z(L({},n),{badge_image:m}))};return a(I,{spacing:2,sx:{my:{xs:3,md:6}},children:[Object.keys(o).length>0?e(U,{severity:"error",children:"Something went wrong - Please fix the errors below."}):null,w?a(U,{severity:"success",children:[" ",w]}):null,n?a(X,{children:[a(I,{component:"form",onSubmit:D,spacing:2,children:[e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"Your Attendee Infomation"}),a(p,{variant:"body1",color:"inherit",children:["Email: ",n.email]}),a(p,{variant:"body1",color:"inherit",children:["Badge Number:"," ",n.badge_override?n.badge_override:n.id]}),e($,{children:e(A,{variant:"outlined",onClick:C,children:"Change Password"})})]})}),e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(we,{userInfo:n,onChange:b,disabled:l==1,errors:o,isSignup:!1})}),e(B,{loading:l==1,loadingPosition:"center",type:"submit",variant:"contained",color:l==2?"success":"primary",children:l==2?"Saved!":"Save Changes"}),e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(pe,{emergencyContact:n,onChange:g,disabled:l==1,errors:o})}),e(B,{loading:l==1,loadingPosition:"center",type:"submit",variant:"contained",color:l==2?"success":"primary",children:l==2?"Saved!":"Save Changes"})]}),e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(Gt,{user:n})}),e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:e(Bt,{user:n,badgeImageChanged:f})})]}):null,e(Ft,{open:d,handleClose:T})]})}function Wt(){const t=H(),{uid:n,token:r}=Je(),[o,i]=s.exports.useState(""),[l,c]=s.exports.useState(""),[d,h]=s.exports.useState(""),[w,y]=s.exports.useState(!1),[C,T]=s.exports.useState(!1),_=W(b=>b.user.authed);s.exports.useEffect(()=>{_&&t(P("/manage")),(!n||!r)&&t(P("/"))},[]);const D=b=>{if(b.preventDefault(),y(!0),!n||!r){h("Invalid token"),y(!1);return}if(o!=l){h("Passwords do not match"),y(!1);return}yt(o,n,r).then(f=>{f.status==204?T(!0):f.json().then(m=>{console.log(m),h(m.token||m.new_password),y(!1)})})},k=b=>{i(b.target.value)},u=b=>{c(b.target.value)},g=()=>{t(P("/login"))};return a(I,{component:"form",onSubmit:D,spacing:2,sx:{my:{xs:3,md:3}},children:[d?e(U,{severity:"error",children:d}):null,e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"New Password"}),e(v,{required:!0,fullWidth:!0,disabled:w,type:"password",name:"password",onChange:k,value:o,label:"Password"}),e(v,{required:!0,fullWidth:!0,disabled:w,type:"password",name:"confirm_password",onChange:u,value:l,label:"Confirm Password"})]})}),e(B,{loading:w,loadingPosition:"center",type:"submit",variant:"contained",children:"Change Password"}),a(ee,{open:C,onClose:g,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(te,{id:"alert-dialog-title",children:"Password Changed"}),e(ne,{children:e(Q,{id:"alert-dialog-description",children:"Your password has been changed! You can now log in."})}),e(re,{children:e(A,{onClick:g,autoFocus:!0,children:"Log In"})})]})]})}function Ht(){const t=H(),[n,r]=s.exports.useState(""),[o,i]=s.exports.useState(!1),[l,c]=s.exports.useState(!1),d=W(C=>C.user.authed);s.exports.useEffect(()=>{d&&t(P("/manage"))},[]);const h=C=>{C.preventDefault(),i(!0),bt(n).then(()=>{i(!1),c(!0)})},w=C=>{r(C.target.value)},y=()=>{t(P("/login"))};return a(I,{component:"form",onSubmit:h,spacing:2,sx:{my:{xs:3,md:3}},children:[e(N,{variant:"outlined",sx:{p:{xs:2,md:3}},children:a(I,{spacing:2,children:[e(p,{variant:"h6",color:"inherit",children:"Forgot Password"}),e(v,{required:!0,fullWidth:!0,autoFocus:!0,disabled:o,type:"email",autoComplete:"email",name:"email",value:n,onChange:w,label:"Email Address"})]})}),e(B,{loading:o,loadingPosition:"center",type:"submit",variant:"contained",children:"Send recovery email"}),a(ee,{open:l,onClose:y,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(te,{id:"alert-dialog-title",children:"Email sent"}),e(ne,{children:a(Q,{id:"alert-dialog-description",children:["If an account exists for ",n,", then an email has been sent."]})}),e(re,{children:e(A,{onClick:y,autoFocus:!0,children:"Log In"})})]})]})}Ze.render(e(Ve.StrictMode,{children:e($e,{store:se,children:e(it,{children:e(Xe,{history:mt,children:a(Qe,{children:[e(z,{path:"/",element:e(gt,{})}),e(z,{path:"/login",element:e(At,{})}),e(z,{path:"/recover",element:e(Ht,{})}),e(z,{path:"/recover/confirm/:uid/:token",element:e(Wt,{})}),e(z,{path:"/newregistration",element:e(Rt,{})}),e(z,{path:"/manage",element:e(Ut,{})})]})})})})}),document.getElementById("root"));Et().then(t=>{t.status==200&&t.json().then(n=>{const r={};n.results.map(o=>{r[o.id]=o.value}),se.dispatch(lt(r))})});
